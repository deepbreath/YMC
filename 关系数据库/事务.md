#### 什么是事务?
是一组不可分割的工作行为, 对这种要么全部成功,要么全部失败的一组行为,称之为事务.
事务就是由各种操作组合而成的具有某些特性的组合操作,某些特性是 满足 ACID 四个属性

#### ACID
什么是ACID?
保证事务执行的四种属性
A 原子性 (Atomicity)  
    什么是原子性?
    决定事务[要么全部完成,要么全部取消],及时运行很长时间.如果事务崩溃,状态回到事务之前
由 undo log 日志保证,记录了需要回滚的日志信息,事务回滚时撤销已经执行成功的 SQL  
C 一致性 (Consistency)  
    什么是一致性?  
    一般由代码层面保证  
I 隔离性 (Isolation)    
    什么是隔离性?  
由 MVCC 保证    
D 持久性 (Durability)    
    什么是持久性 ?  
由内存+redo log来保证,mysql修改数据的同时需要在内存中和redo log 中 记录这次操作,事务提交的时候    
通过 redo log 写入磁盘,宕机的时候可以从 redo log 中恢复    

事务场景?  
一个支持事务(Transaction)中的数据库系统,必须具有的四种特性,    
否则在事务过程中(Transaction processing) 无法保证数据的正确性.  
交易过程极有可能达不到交易  

原子性  --->并发/无并发------>一致性----->执行结果正确
隔离性  --->并发 ---------->持久性------>应对数据库崩溃


#### 并发一致性问题
什么是并发一致性问题?
确保隔离性、一致性和原子性的真正问题是对相同数据的写操作（增、更、删）：   
如果所有事务只是读取数据，它们可以同时工作，不会更改另一个事务的行为。   
如果（至少）有一个事务在修改其他事务读取的数据，数据库需要找个办法对其它事务隐藏这种修改。  
而且，它还需要确保这个修改操作不会被另一个看不到这些数据修改的事务擦除。   
这个问题叫并发控制。  
[摘自](https://www.pdai.tech/md/db/sql/sql-db-howitworks.html#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6)

#### 事务隔离
数据库中事务隔离级别
读未提交 (Read uncommitted)
  会出现脏读,不可重复读,幻读
读已提交 (Read committed)
   出现不可重复读,幻读
重复读 (Repeatable read)
   会出现幻读(但在Mysql实现的Repeatable read配合gap锁不会出现幻读！)
序列化 (Serializable)
    串行避免以上所有问题

什么是脏读 T1, T2 ?
T1 修改的新数据 产生错误回滚 RollBack, 这时 T2 已经读到了 T1 新修改的数据,   
应该读取回滚(RollBack)后的正确数据. 这叫脏读  

什么是幻读(Phantom Read) ?
是在一个事务A内读取与搜索到匹配的若干行范围,此时别的 B 事务插入/或者删除的数据来修改 事务A的结果,  
然后 Commit,导致前后读取不一致. 增加范围锁RangeS,锁定检索范围只读,这样就能避免幻读.  
针对 重复读 (Repeatable read) 这个事务隔离级别,保证读取到的记录加锁(记录锁),  
同时保证对读取范围加锁,新的满足查询条件的记录不能够  
插入(间隙锁),不存在幻读情况

什么是不可重复读 ?
不可重复读的产生是由于查询时系统中其他事务修改的提交而引起的。
例如:在一个事务内多次读取同一个数据,此时事务还没有提交.  
另外一个事务也访问该同一数据进行修改并提交.那么第一个事务两次读取数据之间.由于另外一个事务的修改,  
两次读到的数据不一致,因此称为不可重复读,即原读取不可重复.  

Mysql 事务是如何回滚的?

[此处关联一条 Sql 语句的执行过程](./一条Sql语句的执行过程.md)


#### 分布式事务
什么是分布式事务用来干嘛的?
随着架构规模越来越大,多个子系统通过网络通信相互协作配合完成各个功能,为了保证多系统之间的数据一致行,我们称跨系统的事务为分布式事务,
具体而言,分布式事务是指事物的参与者,支持事务的服务器,资源服务器以及事务管理分别位于不同的分布式系统的不同节点上.

分布式事务的处理方式
涉及CAP理论
什么是两段提交和三段提交?

涉及BASE理论

分布式事务最终处理的问题是,分布式的数据一致性问题

CAP理论:
一致性(Consistency)

可用性(Availability)

分区容错性(Partition)

CAP理论告诉我们 C,A,P三者不能同时满足,最多只能满足其中两个?

为什么?

为什么会有 CAP 理论?

CAP 和 BASE 两者之间的关系
ACID是传统数据库常用的设计理念,追求强一致性模型,BASE支持的是大型分布式系统,提出通过牺牲强一致性获得高可用.
ACID 和 BASE 是两种 
